LISTING FOR LOGIC DESCRIPTION FILE: DEVMAP.pld                       Page 1

CUPL(WM): Universal Compiler for Programmable Logic
Version 5.0a Serial# 60008009
Copyright (c) 1983, 1998 Logical Devices, Inc.
Created Wed Apr 17 22:06:50 2024

  1:Name     DEVMAP;
  2:PartNo   DEVMAP;
  3:Date     03/30/2024;
  4:Revision 01;
  5:Designer Sponaugle;
  6:Company  Ratiometric;
  7:Assembly None;
  8:Location None;
  9:Device   f1508isptqfp100;
 10:
 11:PROPERTY ATMEL {TDI_PULLUP = ON};
 12:PROPERTY ATMEL {TMS_PULLUP = ON};
 13:PROPERTY ATMEL {PREASSIGN = KEEP};
 14:
 15:/* 
 16:                                                Inputs
 17:    ##########################################################################################
 18:*/
 19:
 20:// From CPU

 21:Pin[52,53,54,55,56,57,58,60,61,63,64,65,67,68,69,70,71,72,75,76] = [CPU_A27..8];
 22:Pin[100] = CPU_RW;
 23:
 24:// From Bus Controller CPLD

 25:Pin[1] = nDEV8BITCS;
 26:Pin[2] = nDEV16BITCS;
 27:Pin[5] = nDEV32BITCS;
 28:
 29:Pin[87] = CPU_CLK;
 30:Pin[88] = nSYS_RESET;
 31:Pin[33] = nEXP_CACHE_CTRL;
 32:
 33:/* 
 34:                                                Outputs 
 35:   ##########################################################################################
 36:*/
 37:
 38:Pin[29] = nEXP_DEV8BITCS;
 39:Pin[30] = nEXP_DEV16BITCS;
 40:Pin[31] = nEXP_DEV32BITCS;
 41:Pin[32] = nEXP_DEV_WAIT;
 42:
 43:
 44:Pin[6] = nDEV_WAIT;
 45:Pin[93] = SYS_RESET_POS;  // Inverted version of reset, needed for the UART IC.

 46:Pin[25] = nUART_CSA;
 47:Pin[24] = nUART_CSB;
 48:Pin[28] = nPTC_CS;
 49:Pin[50] = nIDE1_CSA;
 50:Pin[49] = nIDE1_CSB;
 51:Pin[48] = nIDE2_CSA;
 52:Pin[47] = nIDE2_CSB;
 53:Pin[46] = nIDE_WR;

LISTING FOR LOGIC DESCRIPTION FILE: DEVMAP.pld                       Page 2

CUPL(WM): Universal Compiler for Programmable Logic
Version 5.0a Serial# 60008009
Copyright (c) 1983, 1998 Logical Devices, Inc.
Created Wed Apr 17 22:06:50 2024

 54:Pin[45] = nIDE_BUFFER_EN1;
 55:Pin[44] = nIDE_BUFFER_EN2;
 56:
 57:Pin[13] = nINTCTRL_CS;
 58:Pin[14] = nRTC_CS;
 59:Pin[23] = nEXP_VMEM_CS;
 60:Pin[22] = nEXP_VIO_CS;
 61:
 62:Pin[21] = nBOARDLEDS_CS;
 63:Pin[27] = nVGA_CTRL_CS;
 64:Pin[20] = nUSB_CS;
 65:Pin[19] = nNIC_CS;
 66:
 67:Pin[17] = RTC_A_SEL;
 68:Pin[16] = RTC_D_SEL;
 69:Pin[92,99] = EXPANSION_EXTRA1, EXPANSION_EXTRA2;
 70:Pin[96] = nSEVENSEGA_WR;
 71:Pin[97] = nSEVENSEGB_WR;
 72:Pin[98] = nSTATUSLED_WR;
 73:
 74:
 75:
 76:PINNODE  0  = nIDE_WR_DELAY1, nIDE_WR_DELAY2;
 77:
 78:// dummy expression to force the pins to be assigned.

 79:
 80:EXPANSION_EXTRA1 = EXPANSION_EXTRA2 & nSYS_RESET & nDEV32BITCS & CPU_RW  & nEXP_DEV_WAIT & nEXP_CACHE_CTRL;
 81:
 82:FIELD field_CPU_ADDRESS = [CPU_A27..8];
 83:
 84:SYS_RESET_POS = !nSYS_RESET;
 85:
 86:nDEV_WAIT = 'b'1;       // No Wait States right now for local devices.

 87:
 88:nEXP_DEV8BITCS = nDEV8BITCS;
 89:nEXP_DEV16BITCS = nDEV16BITCS;
 90:nEXP_DEV32BITCS = nDEV32BITCS;
 91:
 92:
 93:
 94:/* 8 bit devices */
 95:
 96:nUART_CSA = nDEV8BITCS # !(field_CPU_ADDRESS:['h'00000XX]);
 97:nUART_CSB = nDEV8BITCS # !(field_CPU_ADDRESS:['h'00001XX]);
 98:nINTCTRL_CS = nDEV8BITCS # !(field_CPU_ADDRESS:['h'00002XX]);
 99:nRTC_CS = nDEV8BITCS # !(field_CPU_ADDRESS:['h'00003XX]);
100:nPTC_CS = nDEV8BITCS # !(field_CPU_ADDRESS:['h'00004XX]);
101:nEXP_VIO_CS = nDEV8BITCS # !(field_CPU_ADDRESS:['h'00005XX]);
102:nEXP_VMEM_CS = 'b'1;
103:
104:/* 16 bit devices */
105:
106:nSTATUS7SEG_CS = nDEV16BITCS # !(field_CPU_ADDRESS:['h'00000XX]);
107:nBOARDLEDS_CS = nDEV16BITCS # !(field_CPU_ADDRESS:['h'00001XX]);

LISTING FOR LOGIC DESCRIPTION FILE: DEVMAP.pld                       Page 3

CUPL(WM): Universal Compiler for Programmable Logic
Version 5.0a Serial# 60008009
Copyright (c) 1983, 1998 Logical Devices, Inc.
Created Wed Apr 17 22:06:50 2024

108:nIDE1_CSA = nDEV16BITCS # !(field_CPU_ADDRESS:['h'00004XX]);
109:nIDE1_CSB = nDEV16BITCS # !(field_CPU_ADDRESS:['h'00005XX]);
110:nIDE2_CSA = nDEV16BITCS # !(field_CPU_ADDRESS:['h'00006XX]);
111:nIDE2_CSB = nDEV16BITCS # !(field_CPU_ADDRESS:['h'00007XX]);
112:nVGA_CTRL_CS = nDEV16BITCS # !(field_CPU_ADDRESS:['h'00008XX] # field_CPU_ADDRESS:['h'00009XX]);
113:nUSB_CS = nDEV16BITCS # !(field_CPU_ADDRESS:['h'0000AXX] # field_CPU_ADDRESS:['h'0000BXX]);
114:nNIC_CS = nDEV16BITCS # !(field_CPU_ADDRESS:['h'00010XX] # field_CPU_ADDRESS:['h'00011XX]
115:                        # field_CPU_ADDRESS:['h'00012XX] # field_CPU_ADDRESS:['h'00013XX]);
116:
117:
118:/* IDE Device custom signals:
119:
120:      nIDE_WR signal goes directly to the /WR pin on both IDE interfaces.   This signal is asserted (low) as soon as     
121:      the CPU_RW signal goes low, which normally happens write at the start of an /AS cycle.  The IDE_WR_DELAY1 and DELAY2 
122:      flip flops are configured such that they both start at 0 when an AS cycle starts.  After 2 CLK_16M cycles the 
123:      DELAY2 signal is set to 1, which directly unasserts the IDE /WR pin.  The allows the /WR pin to have an active rising
124:      edge BEFORE the end of the CPU cpu cycle.  This is critical to allow the IDE interface to latch data, since at the end
125:      of the cycle the output buffers to the IDE inteface are turned off.  This was a fix from the original design which 
126:      assumed the rising edge of the write signal would be sufficienctly ahead of the buffers getting turned off. 
127:      
128:       */
129:
130:nIDE_BUFFER_EN1 = (nIDE1_CSA & nIDE1_CSB);
131:nIDE_BUFFER_EN2 = (nIDE2_CSA & nIDE2_CSB);
132:
133:nIDE_WR = CPU_RW # nIDE_WR_DELAY2;
134:
135:nIDE_WR_DELAY1.d = 'b'1;
136:nIDE_WR_DELAY1.ck = CPU_CLK;
137:nIDE_WR_DELAY1.ar = (nIDE_BUFFER_EN1 & nIDE_BUFFER_EN2)  # !nSYS_RESET;
138:
139:nIDE_WR_DELAY2.d = nIDE_WR_DELAY1;
140:nIDE_WR_DELAY2.ck = CPU_CLK;
141:nIDE_WR_DELAY2.ar = (nIDE_BUFFER_EN1 & nIDE_BUFFER_EN2)  # !nSYS_RESET;
142:
143:/* 
144:    RTC Device custom signals 
145:
146:   RTC_A_SEL is used to change the address/data select lines going to the DS Real Time Clock IC.
147:   It is also used to drive the DS line on the RTC.  The flip flop is reset while RTS_CS is off 
148:   (which is tied to /AS), and then increments to 1 on the next falling edge.  It will stay at 1
149:   until the end of the bus cycle.
150:*/
151:
152:RTC_A_SEL.d = 'b'1;
153:RTC_A_SEL.ck = !CPU_CLK;
154:RTC_A_SEL.ar = nRTC_CS;    /* nRTC_CS is active low, so it will be high while RTS is not being accesses */
155:RTC_D_SEL = !RTC_A_SEL;   /* Since RTA_A_SEL is held at zero when no access, this will be held at one which is off */
156:
157:
158:
159:/*
160:Total dedicated input used:     2/4     (50%)
161:Total I/O pins used             56/80   (70%)

LISTING FOR LOGIC DESCRIPTION FILE: DEVMAP.pld                       Page 4

CUPL(WM): Universal Compiler for Programmable Logic
Version 5.0a Serial# 60008009
Copyright (c) 1983, 1998 Logical Devices, Inc.
Created Wed Apr 17 22:06:50 2024

162:Total Logic cells used          29/128  (22%)
163:Total Flip-Flop used            3/128   (2%)
164:Total Foldback logic used       0/128   (0%)
165:Total Nodes+FB/MCells           29/128  (22%)
166:Total cascade used              0
167:Total input pins                32
168:Total output pins               26
169:Total Pts                       30
170:*/
171:
172:



